<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Welcome to the Coffee Club - My Balance</title>
</head>
<body>
	<img id="photo" width=50 height=50></img> <span id="displayName"></span><a id="logout" href="#">Sair</a>

	<div id="container">
		<h2 id="balance">Saldo: R$ </h2>
		Extrato: <ol id="statement"></ol>
	</div>

	<script src="https://www.gstatic.com/firebasejs/3.4.1/firebase.js"></script>
	<script src="app.js"></script>
	<script>
		firebase.auth().onAuthStateChanged(function(user) {
		  if (user) {
		    var name, email, photoUrl, uid;

			  name = user.displayName;
			  email = user.email;
			  photoUrl = user.photoURL;
			  uid = user.uid;  // The user's ID, unique to the Firebase project. Do NOT use
			                   // this value to authenticate with your backend server, if
			                   // you have one. Use User.getToken() instead.

			  var photo = document.getElementById("photo");
			  photo.src = photoUrl;

			  var displayName = document.getElementById("displayName");
			  displayName.innerText = name;
		  } else {
		    location.href = "index.html"
		  }
		});

	  let balance = 0;
	  var dbRef = firebase.database().ref().child('statement/Adauto');	  
	  let statement = document.getElementById('statement');
	  dbRef.on('value', snap => {
	  	snap.forEach(_ => {	  	
		  	var li = document.createElement('li');
		  	li.innerText = `Data: ${_.val().date} - Valor: ${_.val().value}`;
		  	statement.appendChild(li);
		  	balance += _.val().value;	  
	    });
	    let balanceElement = document.getElementById('balance');
	    balanceElement.innerText += balance;
	  });
	</script>
</body>
</html>